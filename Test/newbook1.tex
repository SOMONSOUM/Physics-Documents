\ProvidesPackage{newbook1}[20/08/2020]
\RequirePackage{polyglossia}
\newfontfamily{\khmerfont}[%
Script=Khmer,%
Ligatures=TeX,%
BoldFont={Khmer M1},%
ItalicFont=*,%
ItalicFeatures={FakeSlant=.25},%
BoldItalicFont={Khmer M1},%
BoldItalicFeatures={FakeSlant=.25},%
SlantedFont=*,
SlantedFeatures={FakeSlant=.15}]{Ang DaunTep}
\setsansfont[%
Script=Khmer,%
Ligatures=TeX,%
BoldFont=*,%
ItalicFont=*,%
BoldItalicFont=*,%
BoldItalicFeatures={FakeSlant=.25},%
SlantedFont=*]{Khmer M1}
\setmonofont[%
Script=Khmer,%
Ligatures=TeX,%
BoldFont=*,%
BoldFeatures={FakeBold=2},%
ItalicFont=*,%
ItalicFeatures={FakeSlant=.25},%
BoldItalicFont=*,%
BoldItalicFeatures={FakeBold=2,FakeSlant=.25},%
SlantedFont=*,%
SlantedFeatures={FakeSlant=.15}]{Ang DaunTep}
\setmainlanguage[numerals=khmer]{khmer}
\newfontfamily{\englishfont}{TeX Gyre Pagella}
\setotherlanguage{english}
\RequirePackage{tcolorbox}
\tcbuselibrary{skins}
\tcbuselibrary{theorems}
\tcbuselibrary{breakable}
\tcbset{frame/.style={%
enhanced,%
breakable,%
boxrule=.7pt,%
titlerule=0pt,%
colback=green,%
colframe=cyan,%
colbacktitle=yellow,%
fonttitle=\color{blue}\bfseries,%
left=.25ex,%
right=.25ex,%
%toptitle=5mm,%
bottomtitle=-.4ex,%
top=.25ex,%
bottom=.25ex,%
attach title to upper=\enspace,%
drop small lifted shadow
}}
\RequirePackage[explicit]{titlesec}
\usetikzlibrary{shapes}
\renewcommand{\@makechapterhead}[1]{%
	{\parindent\z@\raggedleft%
		\ifnum\c@secnumdepth>\m@ne%
		\begin{tikzpicture}[overlay]
		\node [left,draw=magenta,line width=4mm,line width=.7pt,rounded rectangle,minimum height=8ex,inner sep=2pt] (chapbox) at (\textwidth,0) {\color{magenta}\LARGE\bfseries\centering\bfseries
			\space\color{blue}#1} ;
		\path [draw=magenta,line width=4mm] (-2,0)  -- (chapbox.west);
		\path[draw=cyan,line width=4mm](chapbox.east)--(18,0);
		\filldraw[yellow!30](-1.7,-0.7)--(1.5,2)--(-1.5,2)--cycle;
		\draw[line width=1pt,blue] (-1.7,-0.7)--(1.5,2) node[midway,sloped,above]{ \bfseries ជំពូកទី\space \thechapter };
		\draw[cyan,line width=4pt](-1.7,0.5)--(0.1,2);
		\end{tikzpicture}}%
	\fi\par\nobreak\vspace*{2.7ex}}
\titleformat{\section}[block]%
{\gdef\seclabel{}}%
{\gdef\seclabel{\thesection\space}}{\z@}{%
	\begin{tikzpicture}[overlay]
	\node [right,rounded rectangle,minimum height=4ex,draw=magenta,line width=.7pt] (secbox) at (0,0) {\color{magenta}\bfseries\seclabel\color{blue}#1};
	\draw [draw=magenta,line width=3.7pt] (secbox.east) -- (\textwidth,0);
	\end{tikzpicture}}
\titlespacing*{\section}{\z@}{1ex\@plus.1ex\@minus.0ex}{1.5ex\@plus.1ex\@minus.1ex}
\titleformat{\subsection}[block]%
{\gdef\subseclabel{}}%
{\gdef\subseclabel{\thesubsection\space}}{\z@}
{%
	\begin{tikzpicture}[overlay]
	\node [left,minimum height=4ex,draw=magenta,line width=.7pt] (subsecbox) at (\textwidth,0) {\color{magenta}\bfseries\subseclabel\color{blue}#1};
	\draw [draw=cyan,line width=3.7pt] (0,0) -- (subsecbox.west);
	\end{tikzpicture}}
\titlespacing*{\subsection}{\z@}{-1.3ex\@plus.1ex\@minus.1ex}{1.5ex\@plus.1ex\@minus.1ex}
\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{amsthm}
\renewcommand{\proofname}{\bfseries សម្រាយបញ្ជាក់} 
\renewenvironment{proof}[1][\proofname]{\par
	\pushQED{\qed}%
	\normalfont\partopsep=\z@skip \topsep=\z@skip
	\trivlist
	\item[\hskip\labelsep
	\itshape
	#1\@addpunct{.}]\ignorespaces
}{%
	\popQED\endtrivlist\@endpefalse
}
\RequirePackage{enumitem}
\setlist[itemize]{leftmargin=*,noitemsep,labelsep=5\p@}
\setlist[itemize,1]{label=\protect\color{magenta}\protect\ensuremath{\protect\bullet},noitemsep}
\setlist[itemize,2]{label=\protect\color{magenta}\protect\ensuremath{\protect\circ},noitemsep}
\setlist[itemize,3]{label=\protect\color{magenta}\protect\ensuremath{\protect\ast},noitemsep}
\setlist[enumerate]{leftmargin=*,noitemsep,labelsep=5\p@}
\setlist[enumerate,1]{label=\protect\color{magenta}\bfseries\arabic*}
\setlist[enumerate,2]{itemsep=\p@,label=\protect\color{magenta}\bfseries\alph*}
\setlist[enumerate,3]{itemsep=\p@,label=\protect\color{magenta}\roman*}
\renewcommand{\theequation}{\bgroup\bfseries\textcolor{magenta}{\arabic{chapter}.\arabic{equation}}\egroup}
%\renewenvironment{center}{\bgroup\centering}{\egroup}
%\endinput
\newenvironment{lalign}{\bgroup\flushleft}{\egroup}
\newenvironment{ralign}{\bgroup\flushright}{\egroup}
\usepackage{tikz,lipsum}
\tcbuselibrary{skins,breakable}
\newcounter{example}[chapter]
\colorlet{colexam}{cyan}
\newtcolorbox[use counter=example]{example}{%
empty,title={ឧទាហរណ៍ \thetcbcounter},attach boxed title to top left={xshift=-4mm,yshift=-2mm},
	coltitle=blue,fonttitle=\bfseries,
	before=\par \noindent,parbox=false,boxsep=-1pt,left=-0.8pt, right=0mm,top=0pt,
	breakable,pad at break*=-0.1mm,
	overlay unbroken={\draw[colexam,line width=2pt]
		([xshift=-0.5pt,yshift=-11pt]title.north east)--([xshift=-0.5pt,yshift=-11pt]title.north-|frame.east); },%
}
\newtheorem{practice}{\textcolor{magenta}{\bfseries ប្រតិបត្តិ\,}}
\newmdtheoremenv[ hidealllines=true, innerleftmargin=7pt,%
innerrightmargin=9pt, innertopmargin=-2pt,%
innerbottommargin=3pt,backgroundcolor=pink!25]
{theorem}{\theoremname}[chapter]
\newmdtheoremenv[hidealllines=true,innerleftmargin=9pt,
innerrightmargin=9pt,innertopmargin=-2pt,innerbottommargin=5pt,
backgroundcolor=magenta!8]{proposition}{\propositionname}[chapter]
\newmdtheoremenv[hidealllines=true,innerleftmargin=9pt,
innerrightmargin=9pt,innertopmargin=-2pt,innerbottommargin=5pt,backgroundcolor=gray!15]{definition}{\definitionname}[chapter]
\newmdtheoremenv[hidealllines=true,innerleftmargin=9pt,
innerrightmargin=9pt,innertopmargin=-2pt,innerbottommargin=5pt,backgroundcolor=green!10]{remark}{\remarkname}[chapter]
\newmdtheoremenv[hidealllines=true,innerleftmargin=9pt,
innerrightmargin=9pt,innertopmargin=2pt,innerbottommargin=6pt,backgroundcolor=yellow!10]{general}{\generalname}[chapter]